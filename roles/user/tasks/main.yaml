- name: setting up nodejs
  ansible.builtin.import_role:
    name: common
    tasks_from: nodejs.yaml
- name: creating app directory
  ansible.builtin.import_role:
    name: common
    tasks_from: setup-app.yaml
- name: download npm
  ansible.builtin.command: npm install 
  args:
    chdir: /app 
- name: copying "{{ component }}".service
  ansible.builtin.copy:
    src: "{{ component }}.service"
    dest: "/etc/systemd/system/{{ component }}.service"
    remote_src: yes   
- name: daemon_reload "{{ component }}"
  ansible.builtin.systemd:
    daemon_reload: true  
- name: Start service "{{ component }}", if not started
  ansible.builtin.service:
    name: "{{ component }}"
    state: started  
    enabled: yes  
- name: copying mongo.repo
  ansible.builtin.copy:
    src: mongo.repo
    dest: /etc/yum.repos.d/mongo.repo  
- name: installing mongodb-org-shell
  ansible.builtin.yum:
    name: mongodb-org-shell
    state: installed    
- name: loading schema
  ansible.builtin.shell: mongo --host mongodb.rakeshreddy.online </app/schema/user.js          
            